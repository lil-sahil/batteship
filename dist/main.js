(()=>{"use strict";let e=()=>{let e={rows:[0,1,2,3,4,5,6,7,8,9].length,cols:[0,1,2,3,4,5,6,7,8,9].length},t=[],r={},o=e=>0===e.filter((e=>{if("-"===e)return e})).length;return{createGameboard:()=>{for(let t=0;t<e.rows;t++)r[`row_${t}`]=Array(e.cols).fill("");return r},placeShip:(t,i,n,a=horizontal)=>{let l=n.shipInfo.shipLength;if(!((t,i,n,a)=>{let l=[];if("vertical"==a){if(t+n>e.cols)return!1;for(let e=t;e<t+n;e++)l.push(r[`row_${e}`][i]);return!!o(l)}if("horizontal"===a){if(i+n>e.rows)return!1;for(let e=i;e<i+n;e++)l.push(r[`row_${t}`][e]);return!!o(l)}})(t,i,l,a))return!1;if("horizontal"===a){let e=r[`row_${t}`];r[`row_${t}`]=e.map(((e,r)=>r>=i&&r<i+l?(n.addShipCoordinate([t,r]),"-"):""))}else if("vertical"===a)for(let e=t;e<t+l;e++)r[`row_${e}`][i]="-",n.addShipCoordinate([e,i]);return r},attack:(e,r,o)=>{for(let o of t)if(o[0]===e&&o[1]===r)return!1;for(let t of o)for(let o of t.shipInfo.shipCoordinates)o[0]===e&&o[1]===r&&t.recieveAttack();t.push([e,r])},spotsPlayed:t,allSunk:e=>!(e.reduce(((e,t)=>!0===t.shipInfo.isSunk?e+1:!1===t.shipInfo.isSunk?e-1:void 0),0)<=0)}},t=e=>{let t={shipLength:e,isSunk:!1,shipCoordinates:[],hitsTaken:0},r=()=>t.hitsTaken>=e&&(t.isSunk=!0,!0);return{shipInfo:t,addShipCoordinate:e=>{t.shipCoordinates.push(e)},isSunk:r,recieveAttack:()=>{t.hitsTaken+=1,r()}}},r=document.querySelector("section#title"),o=(document.querySelector(".main-container"),document.querySelector("section#player-one")),i=document.querySelector("section#player-two"),n=(document.querySelector("section#information"),()=>document.querySelectorAll("section#player-one .gameboard .gameboard-cell")),a=e=>{for(let t of e)for(let e of t.shipInfo.shipCoordinates)n().forEach((t=>{parseInt(t.dataset.row)===e[0]&&parseInt(t.dataset.col)===e[1]&&(t.textContent="X")}))},l=e=>e[Math.floor(Math.random()*e.length)],s=(e,r)=>{let o=[];return{ships:o,initialSetUp:()=>(o=(()=>{for(let e in{carrier:5,Battleship:4,Cruiser:3,Submarine:3,Destroyer:2})o.push(t({carrier:5,Battleship:4,Cruiser:3,Submarine:3,Destroyer:2}[e]));return o})(),(()=>{if(e){for(let e of o){let t=l([0,1,2,3,4,5,6,7,8,9]),o=l([0,1,2,3,4,5,6,7,8,9]),i=l(["horizontal","vertical"]);for(;!1===r.placeShip(t,o,e,i);)t=l([0,1,2,3,4,5,6,7,8,9]),o=l([0,1,2,3,4,5,6,7,8,9]),i=l(["horizontal","vertical"])}return!0}if(!1===e){let e=0;n().forEach((t=>{t.addEventListener("click",(t=>{if(e>=o.length)return!0;let i=t.target.dataset.row,n=t.target.dataset.col;r.placeShip(parseInt(i),parseInt(n),o[e],"horizontal")&&(e++,a(o),console.log(e))}))}))}})(),!0)}},c=()=>{r.appendChild((()=>{let e=document.createElement("div");return e.textContent="BattleShip",e})())},d=(()=>{let e=()=>{let e=document.createElement("div");e.classList.add("gameboard");let t=[0,1,2,3,4,5,6,7,8,9],r=[0,1,2,3,4,5,6,7,8,9];for(let o of t)for(let t of r){let r=document.createElement("div");r.classList.add("gameboard-cell"),r.setAttribute("data-row",o),r.setAttribute("data-col",t),e.appendChild(r)}return e};return{renderComponent:()=>{o.appendChild(e()),i.appendChild(e())}}})();(()=>{c(),d.renderComponent();let t=e(),r=e();t.createGameboard(),r.createGameboard();let o=s(!1,t),i=s(!0,r);o.initialSetUp(),i.initialSetUp(),a(o.ships)})()})();